<template name="goal_card">
<div id="{{goal._id}}" class="ui card goal-card {{#if goal.complete}}complete{{/if}} {{#if isActive goal._id}}active-goal{{/if}}">
  <div class="content">

    {{#if goal.complete}}
    <i class="right floated green checkmark link icon goal-complete-button"></i>
    {{else}}
    <div class="ui right floated simple dropdown">
      <i class="vertical ellipsis icon"></i>
      {{> goal_menu goal=goal addSubgoalsAction=true hideCompletedSubgoalsAction=true}}
    </div>
    {{/if}}

    <div class="header">
      <a href="{{pathFor route='goal' _id=goal._id}}">
        {{goal.title}}
      </a>
    </div>

    <ul class="ui list goal-card-checklist" style="list-style: none">
      {{#each filteredSubgoals}}
        {{> subgoal_row goal=this}}
      {{/each}}
    </ul>

    {{#if editing}}
      {{> new_subgoal_box}}
    {{/if}}

  </div>

</div>
</template>


<template name="subgoal_row">
<li id="{{goal._id}}" class="item subgoal-row {{#if goal.complete}}complete{{/if}} {{#if isActive goal._id}}active-goal{{/if}}">
  {{#if goal.complete}}
    <i class="small checkmark link icon goal-complete-button"></i>
  {{else}}
    {{#if ../../goal.complete}}
      <i class="small {{#if subgoalCount}}plus{{else}}radio{{/if}} link icon goal-complete-button"></i>
    {{else}}
      <div class="ui left floated simple dropdown">
        <i class="small {{#if subgoalCount}}plus{{else}}radio{{/if}} link icon goal-complete-button"></i>
        {{> goal_menu goal=goal tiered=true popAction=true subgoalCount=subgoalCount completedSubgoalCount=completedSubgoalCount}}
      </div>
    {{/if}}
  {{/if}}
  <div class="content subgoal-title-cell">
    <a href="{{pathFor route='goal' _id=../../goal._id hash=goal._id}}">
      {{goal.title}}
    </a>
  </div>
</li>
</template>


<template name="new_subgoal_box">
<div class="ui fluid action input new-subgoal-box">
  <input type="text" placeholder="New Subgoal" id="new-subgoal-title">
  <div id="add-subgoal-button" class="ui purple icon button">
    <i class="icon plus"></i>
  </div>
</div>
</template>
